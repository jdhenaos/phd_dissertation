---
title: "MIBC"
author:
  - Juan Henao:
      orcid: 0000-0003-0783-1432
title-block-published: "Last updated"  
date: now
date-format: long
format: 
  docx:
    reference-doc: "../templates/template.docx" # Insert path for the DOCX file
execute:
  echo: true
  warning: false
  message: false
  comment: "#>"
  fig-path: "../figures/"
  fig-dpi: 600
filters:
  - ../templates/scholarly-metadata.lua
  - ../templates/author-info-blocks.lua
  - ../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
abstract: |
  Text of abstract
keywords: |
  keyword 1; keyword 2; keyword 3
highlights: |
  These are the highlights. 
---

# No noise

## Number of nodes

### Single-omics

```{r}
library(tidyverse)
library(data.table)
library(reshape)
library(ggplot2)
library(dplyr)
library(viridis)

#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"
file_dir <- "/workspaces/phd_dissertation/kimono/analysis/figures/MIBC/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (n_cnv+n_genes+n_methylation), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot1 <- p + geom_line(data = dat, 
                          aes(y= (n_cnv+n_genes+n_methylation), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot1

ggsave(paste0(file_dir,"so/noise_0_so_nodes.pdf"), plot=to.plot1, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (n_cnv+n_genes+n_methylation), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot1 <- p + geom_line(data = dat, 
                          aes(y= (n_cnv+n_genes+n_methylation), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot1

ggsave(paste0(file_dir,"moran/noise_0_moran_nodes.pdf"), plot=to.plot1, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (n_cnv+n_genes+n_methylation), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot1 <- p + geom_line(data = dat, 
                          aes(y= (n_cnv+n_genes+n_methylation), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot1

ggsave(paste0(file_dir,"mos/noise_0_mos_nodes.pdf"), plot=to.plot1, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## Transitivity

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (clustering), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot2 <- p + geom_line(data = dat, 
                          aes(y= (clustering), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot2

ggsave(paste0(file_dir,"so/noise_0_so_transitivity.pdf"), plot=to.plot2, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (clustering), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot2 <- p + geom_line(data = dat, 
                          aes(y= (clustering), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot2

ggsave(paste0(file_dir,"moran/noise_0_moran_transitivity.pdf"), plot=to.plot2, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (clustering), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot2 <- p + geom_line(data = dat, 
                          aes(y= (clustering), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot2

ggsave(paste0(file_dir,"mos/noise_0_mos_transitivity.pdf"), plot=to.plot2, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## Median R-squared

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (median_r2), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot3 <- p + geom_line(data = dat, 
                          aes(y= (median_r2), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot3

ggsave(paste0(file_dir,"so/noise_0_so_rsquared.pdf"), plot=to.plot3, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi_omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (median_r2), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot3 <- p + geom_line(data = dat, 
                          aes(y= (median_r2), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot3

ggsave(paste0(file_dir,"moran/noise_0_moran_rsquared.pdf"), plot=to.plot3, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (median_r2), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot3 <- p + geom_line(data = dat, 
                          aes(y= (median_r2), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot3

ggsave(paste0(file_dir,"mos/noise_0_mos_rsquared.pdf"), plot=to.plot3, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## F1-score (reference)

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_reference), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot4 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_reference), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot4

ggsave(paste0(file_dir,"so/noise_0_so_reference.pdf"), plot=to.plot4, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_reference), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot4 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_reference), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot4

ggsave(paste0(file_dir,"moran/noise_0_moran_reference.pdf"), plot=to.plot4, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_reference), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot4 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_reference), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot4

ggsave(paste0(file_dir,"mos/noise_0_mos_reference.pdf"), plot=to.plot4, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## F1-score (stability selection)

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_stability), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot5 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_stability), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot5

ggsave(paste0(file_dir,"so/noise_0_so_stability.pdf"), plot=to.plot5, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_stability), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot5 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_stability), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot5

ggsave(paste0(file_dir,"moran/noise_0_moran_stability.pdf"), plot=to.plot5, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_stability), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot5 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_stability), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot5

ggsave(paste0(file_dir,"mos/noise_0_mos_stability.pdf"), plot=to.plot5, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

# Noise

## Number of nodes

### Single-omics

```{r}
library(tidyverse)
library(data.table)
library(reshape)
library(ggplot2)
library(dplyr)
library(viridis)

#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (n_cnv+n_genes+n_methylation), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot1 <- p + geom_line(data = dat, 
                          aes(y= (n_cnv+n_genes+n_methylation), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot1

ggsave(paste0(file_dir,"so/noise_05_so_nodes.pdf"), plot=to.plot1, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (n_cnv+n_genes+n_methylation), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot1 <- p + geom_line(data = dat, 
                          aes(y= (n_cnv+n_genes+n_methylation), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot1

ggsave(paste0(file_dir,"moran/noise_05_moran_nodes.pdf"), plot=to.plot1, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (n_cnv+n_genes+n_methylation), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot1 <- p + geom_line(data = dat, 
                          aes(y= (n_cnv+n_genes+n_methylation), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot1

ggsave(paste0(file_dir,"mos/noise_05_mos_nodes.pdf"), plot=to.plot1, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## Transitivity

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (clustering), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot2 <- p + geom_line(data = dat, 
                          aes(y= (clustering), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot2

ggsave(paste0(file_dir,"so/noise_05_so_transitivity.pdf"), plot=to.plot2, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (clustering), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot2 <- p + geom_line(data = dat, 
                          aes(y= (clustering), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot2

ggsave(paste0(file_dir,"mos/noise_05_moran_transitivity.pdf"), plot=to.plot2, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (clustering), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot2 <- p + geom_line(data = dat, 
                          aes(y= (clustering), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot2

ggsave(paste0(file_dir,"mos/noise_05_mos_transitivity.pdf"), plot=to.plot2, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## Median R-squared

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (median_r2), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot3 <- p + geom_line(data = dat, 
                          aes(y= (median_r2), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot3

ggsave(paste0(file_dir,"so/noise_05_so_rsquared.pdf"), plot=to.plot3, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi_omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (median_r2), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot3 <- p + geom_line(data = dat, 
                          aes(y= (median_r2), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot3

ggsave(paste0(file_dir,"moran/noise_05_moran_rsquared.pdf"), plot=to.plot3, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (median_r2), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot3 <- p + geom_line(data = dat, 
                          aes(y= (median_r2), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot3

ggsave(paste0(file_dir,"mos/noise_05_mos_rsquared.pdf"), plot=to.plot3, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## F1-score (reference)

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_reference), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot4 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_reference), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot4

ggsave(paste0(file_dir,"so/noise_05_so_reference.pdf"), plot=to.plot4, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_reference), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot4 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_reference), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot4

ggsave(paste0(file_dir,"moran/noise_05_moran_reference.pdf"), plot=to.plot4, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_reference), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot4 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_reference), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot4

ggsave(paste0(file_dir,"mos/noise_05_mos_reference.pdf"), plot=to.plot4, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

## F1-score (stability selection)

### Single-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'so' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'so' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_stability), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot5 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_stability), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot5

ggsave(paste0(file_dir,"so/noise_05_so_stability.pdf"), plot=to.plot5, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Multi-omics

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'moran' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'moran' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_stability), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot5 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_stability), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot5

ggsave(paste0(file_dir,"moran/noise_05_moran_stability.pdf"), plot=to.plot5, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

### Block-wise

```{r}
#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/derived_data/"

#load library
setwd(dir)

dat_raw <- fread("221116_all_project_info.csv")

#dat_raw <- cbind(dat_raw[,c(1,2,3,16,18)],nodes=dat_raw$V6+dat_raw$V8+dat_raw$V10)
#dat_raw <- dat_raw[dat_raw$iteration == 1,]

dat_raw$method <- gsub(pattern = "_moran|_mos|_mor|_so|_sor",replacement = "",x = dat_raw$method)

dat <- dat_raw[tolower(dat_raw$method) %in% c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso"),]


#ggplot(dat, aes(x=clustering, y=n_genes+n_methylation+n_cnv, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(y=clustering, x=missingness, color=as.factor(method)) )+
#  geom_point(alpha=0.5) + facet_grid(experiment~noise)

#ggplot(dat, aes(x=missingness, y=clustering,fill=as.factor(method)))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)


dat$method <- as.factor(dat$method) 
dat <- dat %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat$experiment <- as.factor(dat$experiment)
dat <- dat %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

dat <- aggregate(dat[, -c(1:8)], list('noise'=dat$noise,
                                      'missingness'=dat$missingness,
                                      'method'=dat$method,
                                      'experiment'=dat$experiment), function(x){mean(x,na.rm=TRUE)})

dat_raw$method <- as.factor(dat_raw$method) 
dat_raw <- dat_raw %>% mutate(method = fct_relevel(method,  "knnkimono",    "galasso_false" ,"galasso_true" ,  "salasso_false" , "salasso_true" ,"cocolasso",  "hmlasso"  ))
dat_raw$experiment <- as.factor(dat_raw$experiment)
dat_raw <- dat_raw %>% mutate(experiment = fct_relevel(experiment,  "so",    "moran" ,"mos" ,  "sor" , "mor"))

dat_raw <- dat_raw[ dat_raw$noise==0.5 & dat_raw$experiment %in% 'mos' & !dat_raw$method %in% "bdcoco_lasso",]
dat <- dat[ dat$noise==0.5 & dat$experiment %in% 'mos' & !dat$method %in% "bdcoco_lasso",]

dat_raw$adaptive <- grepl(pattern = "true",x = dat_raw$method)
dat$adaptive <- grepl(pattern = "true",x = dat$method)

p <- ggplot(dat_raw, 
            aes(y= (f1_score_stability), x=missingness,color=as.factor(method)))+
  
  geom_line(aes( group = interaction(method, iteration),linetype=adaptive),alpha = 0.2)+
  facet_grid(noise~experiment, scales="free")+
  scale_color_manual(values = palette_OkabeIto)+
  scale_fill_manual(values = palette_OkabeIto)+ 
  theme_light() +
  theme(legend.position="bottom",
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        strip.background = element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  ) +
  ylab("#Nodes") 

to.plot5 <- p + geom_line(data = dat, 
                          aes(y= (f1_score_stability), x=missingness, color=as.factor(method),linetype=adaptive)) + 
  theme(strip.background = element_blank(), panel.grid.minor = element_blank(),
        legend.position = "none",
        axis.title.x=element_blank(),
        #axis.text.x=element_blank(),
        #axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        #axis.text.y=element_blank(),
        #axis.ticks.y=element_blank(), 
        plot.margin = unit(c(-0.5, -0.5, 0, 0), "cm")
  )

to.plot5

ggsave(paste0(file_dir,"mos/noise_05_mos_stability.pdf"), plot=to.plot5, width = 4, height = 4,device = "pdf",dpi=600, units="cm")
```

# Betweenness

## Single-omics

```{r}
library(tidyverse)
library(data.table)
library(reshape)
library(ggforestplot)

## Transparent colors
## Mark Gardener 2015
## www.dataanalytics.org.uk

t_col <- function(color, percent = 50, name = NULL) {
  #      color = color name
  #    percent = % transparency
  #       name = an optional name for the color
  
  ## Get RGB values for named color
  rgb.val <- col2rgb(color)
  
  ## Make new color using input color as base and alpha set by transparency
  t.col <- rgb(rgb.val[1], rgb.val[2], rgb.val[3],
               max = 255,
               alpha = (100 - percent) * 255 / 100,
               names = name)
  
  ## Save the color
  invisible(t.col)
}

#general setup
dir <- "/workspaces/phd_dissertation/kimono/analysis/data/raw_data/MIBC/bladder_cancer/networks/"

#load library
setwd(dir)

#get all files for one missingness and one noise lvl
get_files_missingness <- function(files_dir,missingness,noise){
  files <- list.files(files_dir)
  files[files %like% paste0("noise_",noise,"_missing_",missingness,"_")]
}

#load -> scale -> extract betweeness
get_scaled_betweeness_DT <- function(file_iteration){
  dat <- fread(file_iteration)
  #scale betweeness by (N-1)(N-2) |N = number of nodes
  N <- length(dat$V1)
  dat$Betweenness <- dat$Betweenness / ((N-1)*(N-2))
  dat <- dat[,c(2,4)] 
  dat
}

#load -> scale -> extract betweeness
get_scaled_betweeness_DT <- function(file_iteration){
  dat <- fread(file_iteration)
  #scale betweeness by (N-1)(N-2) |N = number of nodes
  N <- length(dat$V1)
  dat$Betweenness <- dat$Betweenness / ((N-1)*(N-2))
  dat <- dat[,c(2,4)] 
  dat
}

#combine multiple seed interations
get_betweeness_missingness <- function(files_dir,iterations){
  sub_result <- c()
  sub_result <- paste(files_dir,iterations[1],sep='/') %>% get_scaled_betweeness_DT()
  for (i in 2:length(iterations)) {
    tmp_DT <- paste(files_dir,iterations[i],sep='/') %>% get_scaled_betweeness_DT()
    colnames(tmp_DT) <- c('Node',i)
    sub_result <- merge(sub_result,tmp_DT, by = 'Node',all = TRUE)
  }
  data.table(sub_result[,1] , rowMeans(sub_result[,-1]))
}

#############################################3333

#benchmarks
noise_lvls <- c(0)
missingness_lvls <- c(0,0.1,0.2,0.3,0.4,0.5)

#method

#experiment_list <- c("multi_omics_random","multi_omics_sample","single_omics")
experiment_list <- c("moran","mos","so")
method_list <- c("galasso_false","galasso_true","knnkimono","salasso_false","salasso_true","cocolasso","hmlasso")

overall <- c()

for (experiment in experiment_list) {
  for (method in method_list) {
    files_dir <- paste(dir,method,experiment,sep="/")
    tryCatch(
      expr = { 
        for (noise in noise_lvls) {
          
          result <- c()
          tmp_missingness <- get_files_missingness(files_dir,missingness_lvls[1],noise)
          result <- get_betweeness_missingness(files_dir,tmp_missingness)
          colnames(result) <- c('Node',missingness_lvls[1])
          
          for (i in 2:length(missingness_lvls)) {
            tryCatch(
              expr = {
                
                tmp_missingness <- get_files_missingness(files_dir,missingness_lvls[i],noise)
                tmp_DT <- get_betweeness_missingness(files_dir,tmp_missingness)
                colnames(tmp_DT) <- c('Node',missingness_lvls[i])
                result <- merge(result,tmp_DT, by = 'Node',all = TRUE)
                
              },
              error = function(e){
                
              },
              warning = function(w){
                
              },
              finally = {
                
              }
            )    
          }
          
          
          r <- result[order(result[,2],decreasing = TRUE),][1:200]
          r[is.na(r)] <- 0
          
          tmp_dat <- data.frame(melt(r), method, noise,experiment)
          
          overall <- rbind(tmp_dat,overall)
          
        }
      },
      error = function(e){
        
      },
      warning = function(w){
        
      },
      finally = {
        
      }
    )   
  }
}

##plotting
overall$method %>% unique
exclude <- overall$noise %in% c(0)   

gg_dat <- overall[ exclude,]
#ggplot(gg_dat, aes(x=variable, y=value,fill=method))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)

gg_dat$method <- as.factor(gg_dat$method)
gg_dat <- gg_dat %>% mutate(method = fct_relevel(method,  "knnkimono"  ,   "galasso_false", "galasso_true" ,"salasso_false", "salasso_true" , "cocolasso" ,  "hmlasso" ))
gg_dat$stripe <- as.numeric(gg_dat$method)

my_grey <- t_col(color = "grey",percent = 90)

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

levels(gg_dat$method) <- c( "knnKiMONo" , "GALasso" ,"GALasso\n (adaptive weights)", "SALasso", "SALasso \n(adaptive weights)", "CoCoLasso",  "HMLasso")

gg_dat <- gg_dat[gg_dat$experiment=='so',]


p <-  ggplot(gg_dat, aes(x=method, y=value*100, fill=variable)) + geom_boxplot(lwd=0.3,outlier.size = 0.1) +
  
  theme_light() +
  
  scale_fill_brewer(palette="YlOrBr", 
                    guide = guide_coloursteps(barwidth=3.5), name = "Missingness:") +
  ylab("Betweeness") +
  xlab("")+ 
  theme(legend.position ="none",
        panel.grid.minor = element_blank(),
        axis.text.x = element_blank(),
        axis.title.y=element_blank(),
        axis.text.y = element_text( vjust = 1, hjust=1),
        plot.background = element_rect(fill = "transparent",
                                       colour = NA_character_),
        panel.background = element_rect(fill = "transparent",
                                        colour = NA_character_)) 


p
```

## Multi-omics

```{r}
gg_dat <- overall[ exclude,]
#ggplot(gg_dat, aes(x=variable, y=value,fill=method))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)

gg_dat$method <- as.factor(gg_dat$method)
gg_dat <- gg_dat %>% mutate(method = fct_relevel(method,  "knnkimono"  ,   "galasso_false", "galasso_true" ,"salasso_false", "salasso_true" , "cocolasso" ,  "hmlasso" ))
gg_dat$stripe <- as.numeric(gg_dat$method)

my_grey <- t_col(color = "grey",percent = 90)

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

levels(gg_dat$method) <- c( "knnKiMONo" , "GALasso" ,"GALasso\n (adaptive weights)", "SALasso", "SALasso \n(adaptive weights)", "CoCoLasso",  "HMLasso")

gg_dat <- gg_dat[gg_dat$experiment=='moran',]


p <-  ggplot(gg_dat, aes(x=method, y=value*100, fill=variable)) + geom_boxplot(lwd=0.3,outlier.size = 0.1) +
  
  theme_light() +
  
  scale_fill_brewer(palette="YlOrBr", 
                    guide = guide_coloursteps(barwidth=3.5), name = "Missingness:") +
  ylab("Betweeness") +
  xlab("")+ 
  theme(legend.position ="none",
        panel.grid.minor = element_blank(),
        axis.text.x = element_blank(),
        axis.title.y=element_blank(),
        axis.text.y = element_text( vjust = 1, hjust=1),
        plot.background = element_rect(fill = "transparent",
                                       colour = NA_character_),
        panel.background = element_rect(fill = "transparent",
                                        colour = NA_character_)) 


p
```

## Block-wise

```{r}
gg_dat <- overall[ exclude,]
#ggplot(gg_dat, aes(x=variable, y=value,fill=method))+
#  scale_y_continuous(trans='sqrt') + geom_boxplot() + facet_grid(experiment~noise)

gg_dat$method <- as.factor(gg_dat$method)
gg_dat <- gg_dat %>% mutate(method = fct_relevel(method,  "knnkimono"  ,   "galasso_false", "galasso_true" ,"salasso_false", "salasso_true" , "cocolasso" ,  "hmlasso" ))
gg_dat$stripe <- as.numeric(gg_dat$method)

my_grey <- t_col(color = "grey",percent = 90)

palette_OkabeIto <- c(  "#CC79A7", "#D55E00",  "#E69F00","#0072B2", "#56B4E9", "#009E73", "#F0E442")

levels(gg_dat$method) <- c( "knnKiMONo" , "GALasso" ,"GALasso\n (adaptive weights)", "SALasso", "SALasso \n(adaptive weights)", "CoCoLasso",  "HMLasso")

gg_dat <- gg_dat[gg_dat$experiment=='mos',]


p <-  ggplot(gg_dat, aes(x=method, y=value*100, fill=variable)) + geom_boxplot(lwd=0.3,outlier.size = 0.1) +
  
  theme_light() +
  
  scale_fill_brewer(palette="YlOrBr", 
                    guide = guide_coloursteps(barwidth=3.5), name = "Missingness:") +
  ylab("Betweeness") +
  xlab("")+ 
  theme(legend.position ="none",
        panel.grid.minor = element_blank(),
        axis.text.x = element_blank(),
        axis.title.y=element_blank(),
        axis.text.y = element_text( vjust = 1, hjust=1),
        plot.background = element_rect(fill = "transparent",
                                       colour = NA_character_),
        panel.background = element_rect(fill = "transparent",
                                        colour = NA_character_)) 


p
```